<div id="subtree" plumb-set-container reinstantiate-on="individual.id">

	<div class="parent-family" ng-if="individual.parent_family.isNotEmpty()">
		<div class="node-container">
			<div class="node" id="subtree-parent">
				<span ng-if="individual.parent_family.husband.isNotEmpty()">
					<individual data="individual.parent_family.husband" tree-number="individual.tree_number"></individual>
				</span>
				<span ng-if="individual.parent_family.wife.isNotEmpty() && individual.parent_family.husband.isNotEmpty()">
						<div class="rings" dropdown is-open="ftreesCtrl.marriage_info">
							<div class="rings__no-details"></div>
							<span ng-if="individual.parent_family.husband.marriage_date !== null && individual.parent_family.husband.marriage_place !== null">
								<div class="rings__icon" dropdown-toggle ng-if="!(ftreesCtrl.tree_view)">
									<icon position="[-216, -607]" alt-text="{en: 'Female', he: 'נקבה'}"></icon>
								</div>
								<div class="rings__marriageInfo" ng-click="ftreesCtrl.prevent_dropdown_close($event)">
									<en>Date of marriage:<en> <he>Date of marriage:</he></br>{{individual.parent_family.husband.marriage_date}}<br/>
									<en>Place of marriage:<en><he>Place of marriage:</he></br>{{individual.parent_family.husband.marriage_place}}
								</div>
							</span>
						</div>
					<individual data="individual.parent_family.wife" tree-number="individual.tree_number"></individual>
				</span>
				<span ng-if="individual.parent_family.wife.isNotEmpty() && individual.parent_family.husband.isEmpty()">
					<individual data="individual.parent_family.wife" tree-number="individual.tree_number"></individual>
				</span>
			</div>
		</div>
	</div>

	<div class="node-container">
		<div 	class="node"
				id="subtree-individual"
				plumb-connect to="subtree-parent"
				container-id="subtree"
				connection-id="subtree-individual-parent"
				connector="flowchart"
				delay="1000">

			<span ng-if="individual.sex === 'M'">
				<div class="spouse" id="husband">
					<individual data="individual" tree-number="individual.tree_number" is-selected="true"></individual>
				</div>
			</span>
			<span ng-if="individual.family.spouse.isNotEmpty()">
					<div class="rings" dropdown is-open="ftreesCtrl.marriage_info">
						<div class="rings__no-details"></div>
						<span ng-if="individual.marriage_date !== null && individual.marriage.place !== null">
							<div class="rings__icon" dropdown-toggle ng-if="!(ftreesCtrl.tree_view)">
								<icon position="[-216, -607]" alt-text="{en: 'Female', he: 'נקבה'}"></icon>
							</div>
							<div class="rings__marriageInfo" ng-click="ftreesCtrl.prevent_dropdown_close($event)">
								<en>Date of marriage:<en> <he>Date of marriage:</he> {{individual.marriage_date}} <br/>
								<en>Place of marriage:<en><he>Place of marriage:</he>{{individual.marriage_place}}
							</div>
						</span>
					</div>
				<div class="spouse"
					  plumb-connect to="husband"
				      container-id="subtree-spouse"
				      connection-id="subtree-individual-spouse"
				   	  connector="flowchart" >
					<individual data="individual.family.spouse" tree-number="individual.tree_number"></individual>
				</div>
			</span>
			</span>
			<span ng-if="individual.sex === 'F'">
				<individual data="individual" tree-number="individual.tree_number" is-selected="true"></individual>
			</span>
		</div>


<!-- 		<div 	class="node"
				id="subtree-individual"
				plumb-connect to="subtree-parent"
				container-id="subtree"
				connection-id="subtree-individual-parent"
				connector="flowchart"
				delay="1000">
			<span ng-if="individual.sex === 'M'">
				<individual data="individual" tree-number="individual.tree_number"></individual>
			</span>
			<span ng-if="individual.family.spouse.isNotEmpty()">
				<div class="rings" dropdown is-open="ftreesCtrl.marriage_info">
					<div class="rings__icon" dropdown-toggle ng-if="!(ftreesCtrl.tree_view)">
						<icon position="[-216, -607]" alt-text="{en: 'Female', he: 'נקבה'}"></icon>
					</div>
					<div class="rings__marriageInfo" ng-click="ftreesCtrl.prevent_dropdown_close($event)">
						<en>Date of marriage:<en> {{individual.marriage_date}} <br/>
						<en>Place of marriage:<en>{{individual.marriage_place}}
					</div>
				</div>
				<individual data="individual.family.spouse" tree-number="individual.tree_number"></individual>
			</span>
			<span ng-if="individual.sex === 'F'">
				<individual data="individual" tree-number="individual.tree_number"></individual>
			</span>
		</div> -->


	</div>

	<div 	class="node-container" 
			id="subtree-sibling-{{$index}}"
			ng-repeat="sibling in individual.parent_family.children" 
			ng-if="sibling.id != individual.id"
			plumb-connect to="subtree-parent"
			container-id="subtree"
			connection-id="subtree-sibling-{{$index}}-parent"
			connector="flowchart"
			delay="0">
		<div class="node">
			<span ng-if="sibling.sex === 'M'">
					<individual data="sibling" tree-number="individual.tree_number"></individual>
			</span>
			<!-- <span ng-if="sibling.family.spouse.isNotEmpty()">
				<div class="rings" dropdown is-open="ftreesCtrl.marriage_info">
					<div class="rings__icon" dropdown-toggle ng-if="!(ftreesCtrl.tree_view)">
						<icon position="[-216, -607]" alt-text="{en: 'Female', he: 'נקבה'}"></icon>
					</div>
					<div class="rings__marriageInfo" ng-click="ftreesCtrl.prevent_dropdown_close($event)">
						<en>Date of marriage:<en> {{individual.marriage_date}}<br/>
						<en>Place of marriage:<en>{{individual.marriage_place}}
					</div>
				</div>
					<individual data="sibling.family.spouse" tree-number="individual.tree_number"></individual>
			</span> -->
			<span ng-if="sibling.sex === 'F'">
				<individual data="sibling" tree-number="individual.tree_number"></individual>
			</span>
		</div>
	</div>

	<div class="family" ng-if="individual.family.isNotEmpty()">
		<div 	class="node-container" 
				id="child-{{$index}}"
				ng-repeat="child in individual.family.children"
				plumb-connect to="subtree-individual"
				container-id="subtree"
				connection-id="subtree-child-{{$index}}-individual"
				connector="flowchart"
				delay="0">
			<div class="node">
				<span ng-if="child.sex === 'M'">
					<individual data="child" tree-number="individual.tree_number"></individual>
				</span>
				<span ng-if="child.family.spouse.isNotEmpty()">
					<div class="rings" dropdown is-open="ftreesCtrl.marriage_info">
					<div class="rings__icon" dropdown-toggle ng-if="!(ftreesCtrl.tree_view)">
						<icon position="[-216, -607]" alt-text="{en: 'Female', he: 'נקבה'}"></icon>
					</div>
					<div class="rings__marriageInfo" ng-click="ftreesCtrl.prevent_dropdown_close($event)">
						<en>Date of marriage:<en> {{individual.marriage_date}}<br/>
						<en>Place of marriage:<en>{{individual.marriage_place}}
					</div>
				</div>
				<div class="spouse"
					  plumb-connect to="husband"
				      container-id="subtree-spouse"
				      connection-id="subtree-individual-spouse"
				   	  connector="flowchart" >
					<individual data="child.family.spouse" tree-number="individual.tree_number"></individual>
				</div>
				</span>
				<span ng-if="child.sex === 'F'">
					<individual data="child" tree-number="individual.tree_number"></individual>
				</span>
			</div>
		</div>
	</div>
</div>